<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=yes"
    />
    <title>Nidhish & Sthuthi Engagement Ceremony</title>

    <style>
      /* ===== BACKGROUND ===== */
      .bg {
        position: fixed;
        inset: 0;
        background-size: cover;
        background-position: center;
        filter: blur(18px) brightness(0.6);
        z-index: -1;
        transition: background-image 1.2s ease-in-out;
      }

      body {
        margin: 0;
        font-family: Arial, sans-serif;
        background: #0f172a;
      }

      header {
        background: linear-gradient(135deg, #4f46e5, #3b82f6);
        color: white;
        padding: 16px;
        text-align: center;
        font-size: 22px;
      }

      .tabs {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin: 15px;
        flex-wrap: wrap;
      }

      .tab {
        padding: 10px 22px;
        border-radius: 25px;
        background: rgba(229, 231, 235, 0.9);
        cursor: pointer;
        font-weight: bold;
      }

      .tab.active {
        background: #3b82f6;
        color: white;
      }

      .grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: 15px;
        padding: 15px;
      }

      /* Images */
      .grid img {
        width: 100%;
        height: 160px;
        object-fit: cover;
        border-radius: 12px;
        cursor: pointer;
        user-select: none;
        -webkit-user-drag: none;
      }

      /* Videos - stacked one below the other */
      #videos.grid {
        grid-template-columns: 1fr !important;
      }

      .grid video {
        width: 100%;
        height: auto;
        max-height: 320px;
        display: block;
        margin-bottom: 15px;
        object-fit: contain;
        border-radius: 12px;
        background: black;
      }

      .hidden {
        display: none;
      }

      /* ===== FULLSCREEN OVERLAY ===== */
      .overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.95);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        flex-direction: column;
      }

      .overlay img {
        max-width: 90%;
        max-height: 80%;
        transition: transform 0.3s ease;
        touch-action: pinch-zoom;
        user-select: none;
        -webkit-user-drag: none;
      }

      .top-bar {
        position: fixed;
        top: 10px;
        right: 10px;
        display: flex;
        gap: 10px;
        z-index: 1002;
      }

      .icon-btn {
        background: rgba(0, 0, 0, 0.6);
        color: white;
        border: none;
        font-size: 16px;
        padding: 10px 14px;
        border-radius: 8px;
        cursor: pointer;
      }

      .nav {
        position: fixed;
        top: 50%;
        transform: translateY(-50%);
        font-size: 36px;
        color: white;
        cursor: pointer;
        z-index: 1002;
        padding: 12px;
        background: rgba(0, 0, 0, 0.45);
        border-radius: 50%;
        user-select: none;
      }

      .nav.left {
        left: 10px;
      }
      .nav.right {
        right: 10px;
      }

      /* MOBILE */
      @media (max-width: 600px) {
        .grid img {
          height: 130px;
        }
        .grid video {
          height: auto;
          max-height: 220px;
        }
        .nav {
          font-size: 26px;
          padding: 12px;
        }
      }
    </style>
  </head>

  <body>
    <div class="bg" id="bg"></div>

    <header>üíç Nidhish & Sthuthi Engagement</br> 10-11-2025</header>

    <div class="tabs">
      <div class="tab active" onclick="showTab('images', this)">Images</div>
      <div class="tab" onclick="showTab('videos', this)">Videos</div>
      <div class="tab" onclick="showTab('candid', this)">Nidhish & Sthuthi</div>
    </div>

    <div id="images" class="grid"></div>
    <div id="candid" class="grid hidden"></div>
    <div id="videos" class="grid hidden"></div>

    <!-- OVERLAY -->
    <div class="overlay" id="imageOverlay">
      <div class="top-bar">
        <button class="icon-btn" onclick="downloadImage()">‚¨áÔ∏è Download</button>
        <button class="icon-btn" onclick="closeOverlay()">‚úï</button>
      </div>

      <span class="nav left" onclick="navigate(-1)">‚ùÆ</span>
      <img id="overlayImg" />
      <span class="nav right" onclick="navigate(1)">‚ùØ</span>
    </div>

    <script>
      if (sessionStorage.getItem("authorized") !== "yes") {
        document.body.innerHTML =
          "<h2 style='text-align:center;color:white;margin-top:50px;'>‚ùå Access Denied</h2>";
      }

      let images = [],
        candid = [];
      let currentList = [],
        currentFolder = "";
      let currentIndex = 0,
        rotation = 0,
        bgIndex = 0;

      const bg = document.getElementById("bg");
      const overlayImg = document.getElementById("overlayImg");

      fetch("media.json")
        .then((r) => r.json())
        .then((data) => {
          images = data.images || [];
          candid = data.candid || [];

          loadImages(images, "photos", "images");
          loadImages(candid, "candid", "candid");

          data.videos.forEach((v) => {
            const vid = document.createElement("video");
            vid.src = `videos/${v}`;
            vid.controls = true;
            vid.controlsList = "nodownload";
            document.getElementById("videos").appendChild(vid);
          });

          if (images.length)
            bg.style.backgroundImage = `url(photos/${images[0]})`;

          setInterval(() => {
            if (!images.length) return;
            bgIndex = (bgIndex + 1) % images.length;
            bg.style.backgroundImage = `url(photos/${images[bgIndex]})`;
          }, 5000);
        });

      function loadImages(list, folder, containerId) {
        const container = document.getElementById(containerId);
        list.forEach((img, i) => {
          const el = document.createElement("img");
          el.src = `${folder}/${img}`;
          el.onclick = () => openImage(list, folder, i);
          container.appendChild(el);
        });
      }

      function showTab(tab, el) {
        document
          .querySelectorAll(".tab")
          .forEach((t) => t.classList.remove("active"));
        document
          .querySelectorAll(".grid")
          .forEach((g) => g.classList.add("hidden"));
        document.getElementById(tab).classList.remove("hidden");
        el.classList.add("active");
      }

      function openImage(list, folder, index) {
        currentList = list;
        currentFolder = folder;
        currentIndex = index;
        rotation = 0;
        overlayImg.src = `${folder}/${list[index]}`;
        overlayImg.style.transform = "rotate(0deg)";
        document.getElementById("imageOverlay").style.display = "flex";
      }

      function closeOverlay() {
        document.getElementById("imageOverlay").style.display = "none";
      }

      function navigate(dir) {
        currentIndex =
          (currentIndex + dir + currentList.length) % currentList.length;
        rotation = 0;
        overlayImg.src = `${currentFolder}/${currentList[currentIndex]}`;
        overlayImg.style.transform = "rotate(0deg)";
      }

      overlayImg.onclick = (e) => {
        e.stopPropagation();
        rotation = (rotation + 90) % 360;
        overlayImg.style.transform = `rotate(${rotation}deg)`;
      };

      function downloadImage() {
        const a = document.createElement("a");
        a.href = overlayImg.src;
        a.download = currentList[currentIndex];
        a.click();
      }

      document.addEventListener("contextmenu", (e) => e.preventDefault());
    </script>
  </body>
</html>
